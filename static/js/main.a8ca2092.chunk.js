(this.webpackJsonpexcel2pic=this.webpackJsonpexcel2pic||[]).push([[0],{21:function(e,t){},38:function(e,t,a){},44:function(e,t){},45:function(e,t){},83:function(e,t,a){},86:function(e,t,a){"use strict";a.r(t);var n=a(7),i=a(5),c=a.n(i),o=a(9),s=a.n(o),l=(a(38),a(29)),r=a(30),d=a(32),h=a(31),u=a(19),g=a.n(u),f=a(89),v=a(8),x=a.n(v),m=(a(83),function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).initStage=function(){var e=n.state,t=e.canvasWidth,a=e.canvasHeight,i=new x.a.Stage({x:0,y:0,container:"container",width:t,height:a});n.setState({stage:i})},n.addBox=function(e,t,a){var i=n.state.canvasWidth,c=new x.a.Layer,o=new x.a.Group({Zindex:10,x:i/2-50,y:10+40*t,width:100,height:25,fill:"#00D2FF",stroke:"black",strokeWidth:4,draggable:!0});o.add(new x.a.Rect({width:100,height:25,fill:"lightblue"})),o.add(new x.a.Text({text:a[t],fontSize:18,fontFamily:"Calibri",fill:"#000",width:100,padding:5,align:"center"})),o.on("mouseover",(function(){document.body.style.cursor="pointer"})),o.on("mouseout",(function(){document.body.style.cursor="default"})),c.add(o),e.add(c),n.setState({stage:e})},n.download=function(){var e=n.state.stage,t=document.createElement("a"),a=new MouseEvent("click");t.download="test.jpg",t.href=e.toDataURL({pixelRatio:1}),t.dispatchEvent(a)},n.handleImageChange=function(e){var t=new FileReader,a=e.target.files[0];t.onloadend=function(){var e=new window.Image;e.onload=function(){n.checkImageSize(e.width,e.height,e)},e.src=t.result,n.setState({imageUrl:t.result})},t.readAsDataURL(a)},n.checkImageSize=function(e,t,a){var i=n.state,c=i.stage,o=i.excelTitleData,s=document.getElementById("uploadBgBlock"),l=s.offsetWidth,r=s.offsetHeight,d=new x.a.Layer,h=.2;for(c.destroyChildren();l<e||r<t;)t/=h,e/=h,h+=.2;var u=new x.a.Image({x:0,y:0,image:a,width:e,height:t});if(d.add(u),d.batchDraw(),c.width(e),c.height(t),c.add(d),o)for(var g=0;g<o.length;g++)n.addBox(c,g,o);n.setState({canvasWidth:e,canvasHeight:t})},n.getExcelTitle=function(e){var t=[];for(var a in e[0])t.push(a);n.updateExcelData(t),n.setState({excelTitleData:t})},n.updateExcelData=function(e){var t=n.state,a=t.stage,i=t.imageUrl,c=t.canvasWidth,o=t.canvasHeight;if(i){var s=new x.a.Layer,l=new x.a.Image({x:0,y:0,image:i,width:c,height:o});s.add(l),s.batchDraw(),a.add(s)}for(var r=0;r<e.length;r++)n.addBox(a,r,e)},n.onImportExcel=function(e){for(var t=new FileReader,a=0;a<e.length;a++)t.name=e[a].name;t.onload=function(e){try{var t=[".xlsx",".xls"],a=e.target.name;if(null===a)throw new Error("excel\u6a94\u6848\u6c92\u6709\u4efb\u4f55\u8cc7\u6599");var i=a.substring(a.lastIndexOf("."));if(-1===t.indexOf(i))throw new Error("\u6a94\u6848\u985e\u578b\u932f\u8aa4\uff0c\u53ea\u53ef\u63a5\u53d7\uff1a"+t.toString()+"\u6a94\u6848\u540d\u7a31");var c=e.target.result,o=g.a.read(c,{type:"binary"}),s=[];for(var l in o.Sheets)o.Sheets.hasOwnProperty(l)&&(s=s.concat(g.a.utils.sheet_to_json(o.Sheets[l])));n.getExcelTitle(s),n.setState({excelData:s})}catch(r){return void alert(r)}},t.readAsBinaryString(e[0])},n.download=function(){var e=n.state.stage,t=document.createElement("a"),a=new MouseEvent("click");t.download="test.jpg",t.href=e.toDataURL(),t.dispatchEvent(a)},n.state={image:null,imageUrl:"",stage:null,canvasWidth:250,canvasHeight:250,excelData:[],excelTitleData:[]},n}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.initStage()}},{key:"render",value:function(){var e=this.state,t=e.canvasWidth,a=e.canvasHeight;return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("div",{className:"topBlock",children:Object(n.jsx)("div",{className:"topText",children:"excel2picture demo"})}),Object(n.jsxs)("div",{className:"cotentBlock",children:[Object(n.jsxs)("div",{className:"uploadBlock",children:[Object(n.jsxs)("div",{className:"uploadBgBlock",id:"uploadBgBlock",children:[Object(n.jsx)("input",{type:"file",onChange:this.handleImageChange,accept:"image/*"}),Object(n.jsx)("div",{className:"container",id:"container",style:{width:t,height:a}})]}),Object(n.jsx)("div",{className:"uploadExcelBlock",children:Object(n.jsx)(f.a,{accept:".xlsx, .xls",onChange:this.onImportExcel,children:Object(n.jsx)("button",{className:"btn btn-primary",children:"\u4e0a\u50b3excel\u8cc7\u6599"})})})]}),Object(n.jsx)("button",{className:"readyButton",onClick:this.download,children:"\u958b\u59cb\u751f\u6210\u5716\u7247"})]})]})}}]),a}(c.a.Component)),p=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,90)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),n(e),i(e),c(e),o(e)}))};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(m,{})}),document.getElementById("root")),p()}},[[86,1,2]]]);
//# sourceMappingURL=main.a8ca2092.chunk.js.map